(()=>{let e;function t(t){t.preventDefault();let s=t.target.username.value;!function(t,s){let a=o(5e6),i=o(5e5),u=Math.round(1e5*Math.random()+2),l=n(i,u,a),p=new XMLHttpRequest;p.open("POST","backend/keyexchange.php",!0),p.setRequestHeader("Content-Type","application/json"),p.onreadystatechange=function(){if(4==this.readyState&&200==this.status){let o=this.responseText.split(" "),i=parseInt(o[0]);e=n(i,u,a),function(e,t){let n=new XMLHttpRequest;n.open("POST","backend/symetricLogin.php",!0),n.setRequestHeader("Content-Type","application/json"),n.onreadystatechange=function(){if(4==this.readyState&&200==this.status){let e=this.responseText;console.log("Response: "+e)}};let o={username:t,passwordArray:r(e)};n.send(JSON.stringify(o))}(t,s)}};let d={p:a,g:i,A:l};p.send(JSON.stringify(d))}(t.target.password.value,s)}function n(e,t,n){let o=1;if(0==(e%=n))return 0;for(;t>0;)1&t&&(o=o*e%n),t>>=1,e=e*e%n;return o}function o(e){let t,n=!1;for(;!n;)t=Math.round(Math.random()*e+e/10),s(t)&&(n=!0);return t}function s(e){let t=!1;for(let n=2;n<e;n++)e%n==0&&(t=!0);return!t}function r(t){let n=[];for(let o=0;o<t.length;++o)n.push(t.charCodeAt(o)^e);return n}window.onload=()=>{document.getElementById("loginform").addEventListener("submit",t)}})();